---
layout: default
---

{% include home-header.html %}

<h1>{% t titles.{{ page.title }}  %}</h1>

{% comment %} Check the type of archive {% endcomment %}
{%- if page.type == 'categories' -%}
  {%- assign taxonomies = site.categories -%}
{%- elsif page.type == 'tags' -%}
  {%- assign taxonomies = site.tags -%}
{%- elsif page.type == 'grades' -%}
  {%- assign taxonomies = site.data.grades -%}
{%- else -%}
  {%- assign taxonomies = none -%}
{%- endif -%}

{% comment %} Render taxonomies. For grades we show fixed buckets 25â†’<=20 in that order. {% endcomment %}
{%- if page.type == 'grades' -%}
  {%- assign labels = "25,24.5,24,23.5,23,22.5,22,21.5,21,20.5,20,<=20" | split: "," -%}
  <div class="taxonomies-wrapper">
    <ul class="taxonomies">
      {%- for label in labels -%}
        {%- assign posts_for_label = site.data.grades[label] -%}
        {%- if posts_for_label and posts_for_label.size > 0 -%}
          <li>
            {%- capture link -%}{{ page.permalink }}#grade-{{ label | replace: '<','lt' | slugify }}{%- endcapture -%}
            <a class="taxonomy" href="{{ link | relative_url }}">
              <span>{{ label }}</span>
              <span class="taxonomy-count">{{ posts_for_label.size }}</span>
            </a>
          </li>
        {%- endif -%}
      {%- endfor -%}
    </ul>
  </div>
{%- else -%}
  {% comment %} Calculate the max count of taxonomies {% endcomment %}
  {%- assign max_count = 0 -%}
  {%- for taxonomy in taxonomies -%}
    {%- assign posts = taxonomy[1] -%}
    {%- if posts.size > max_count -%}
      {%- assign max_count = posts.size -%}
    {%- endif -%}
  {%- endfor -%}

  <div class="taxonomies-wrapper">
    <ul class="taxonomies">
      {%- for i in (1..max_count) reversed -%}
        {%- for taxonomy in taxonomies -%}
          {%- assign taxonomy_name = taxonomy[0] -%}
          {%- assign slugified_taxonomy_name = taxonomy_name | slugify -%}
          {%- assign posts = taxonomy[1] -%}
          {%- if posts.size == i -%}
            <li>
              {%- capture link -%}{{ page.permalink }}#{{ slugified_taxonomy_name }}{%- endcapture -%}
              <a class="taxonomy" href="{{ link | relative_url }}">
                <span>
                  {%- if page.type == 'tags' -%}
                    {{ slugified_taxonomy_name }}
                  {%- else -%}
                    {{ taxonomy_name }}
                  {%- endif -%}
                </span>
                <span class="taxonomy-count">{{ posts.size }}</span>
              </a>
            </li>
          {%- endif -%}
        {%- endfor -%}
      {%- endfor -%}
    </ul>
  </div>
{%- endif -%}

{% comment %} Show posts by taxonomy {% endcomment %}
{%- if page.type == 'grades' -%}
  {%- assign labels = "25,24.5,24,23.5,23,22.5,22,21.5,21,20.5,20,<=20" | split: "," -%}
  {%- for label in labels -%}
    {%- assign posts_for_label = site.data.grades[label] -%}
    {%- if posts_for_label and posts_for_label.size > 0 -%}
      <h2 id="grade-{{ label | replace: '<','lt' | slugify }}">{{ label }}</h2>
      <ul class="post-list-by-taxonomy">
        {%- for post in posts_for_label -%}
          <li>
            {%- if post.date and post.date != empty -%}
              <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: "%Y-%m-%d" }}</time>
            {%- endif -%}
            &raquo; <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
          </li>
        {%- endfor -%}
      </ul>
      <a href="#" onclick="backToTop()" class="back-to-top">Top &#8648;</a>
    {%- endif -%}
  {%- endfor -%}
{%- else -%}
  {%- for i in (1..max_count) reversed -%}
    {%- for taxonomy in taxonomies -%}
      {%- assign taxonomy_name = taxonomy[0] -%}
      {%- assign slugified_taxonomy_name = taxonomy_name | slugify -%}
      {%- assign posts = taxonomy[1] -%}
      {%- if posts.size == i -%}
        <h2 id="{{ slugified_taxonomy_name }}">
          {%- if page.type == 'tags' -%}
            {{ slugified_taxonomy_name }}
          {%- else -%}
            {{ taxonomy_name }}
          {%- endif -%}
        </h2>
        <ul class="post-list-by-taxonomy">
          {%- for post in posts -%}
            <li>
              <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: "%Y-%m-%d" }}</time> &raquo; <a href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
            </li>
          {%- endfor -%}
        </ul>
        <a href="#" onclick="backToTop()" class="back-to-top">Top &#8648;</a>
      {%- endif -%}
    {%- endfor -%}
  {%- endfor -%}
{%- endif -%}

<script>
  function backToTop() {
    const main = document.getElementById("site-main");
    main.scrollTop = 0;
  }
</script>
